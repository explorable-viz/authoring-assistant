name: test-misc-website

on:
  workflow_dispatch: 

jobs:
  test:
    strategy:
      matrix:
        os: [ubuntu-22.04, macOS-14]
    runs-on: ${{ matrix.os }}

    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-node@v4
      with:
        node-version: 22
    - name: enable-glob
      run: | 
        shopt -s extglob nullglob globstar
      if: runner.os == 'Linux'
    - name: run-test
      run: |
        cd promptExecutor
        yarn install
        set -x -e
        yarn fluid publish -w Misc -l
        export PUPPETEER_BROWSER_REVISION=1331488
        npx puppeteer browsers install chrome
        npx puppeteer browsers install firefox
        yarn website-test misc
