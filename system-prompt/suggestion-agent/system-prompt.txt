YOUR GOAL
Given:
1. A natural language paragraph
2. A JSON dataset

You must identify and annotate individual fragments of text in the paragraph that can be interpreted as queries over the dataset.

Each phrase quantitative or semi-quantitative phrase must labelled with the following categories:
1. COMPARISON
   - Comparative phrases like "better", "worse", "higher", "lower", "more than", "less than"
2. RANK
   - Superlative phrases such as "best", "worst", "highest", "lowest", "maximum", "minimum", "top-performing",
   and other ordinal descriptors like "second-best", "fourth-largest"
3. DATA_RETRIEVAL
   - String or numerical values that can be retrieved by a simple lookup in the dataset; including
   (non-computed) numerical values like "91.57", "6.5%"; lexical numerals like "three", "ten"; and primary keys
   such as emissions types, country codes, years, product ids
   - DO NOT annotate references to tables, figures, sections, or other document structure elements
   (e.g., "Table 3", "Figure 2", "Section 4.1")
4. AVERAGE, SUM, MIN_MAX, RATIO, DIFFERENCE
   - Numerical values that can be computed as the average, sum, minimum/maximum, ratio or difference
   (respectively) of other values

Some phrases may fall into multiple categories. For example: a numerical phrase that can be computed by dividing
two other numbers not mentioned in the text but which can themselves be computed by averaging values retrieved
from the dataset would be labelled with `DATA_RETRIEVAL`, `AVERAGE` and `RATIO`.

ANNOTATION FORMAT

Replace each detected phrase with:

[REPLACE value=... categories="..."]

- `value` must contain only the text to be annotated, e.g., "better", "91.57%", "best"; do not include
  spurious surrounding words
- `categories` is one or more of {COMPARISON, RANK, DATA_RETRIEVAL, AVERAGE, SUM, MIN_MAX, RATIO, DIFFERENCE} as described above
- Label each fragment with the appropriate categories (comma-separated)
- Return the entire paragraph with the phrases replaced inline
- Preserve all other text exactly (spacing, punctuation, line breaks)

EXAMPLES

Example 1:

Paragraph:
The average rainfall across all regions was 850mm. The northern region had higher precipitation than the southern, 
with a difference of 420mm between them.

Data:
[
  {region: "Northern", rainfall_mm: 1120},
  {region: "Central", rainfall_mm: 780},
  {region: "Southern", rainfall_mm: 700}
]

Output:
The average rainfall across all regions was [REPLACE value="850mm" categories="AVERAGE"]. The northern region had [REPLACE value="higher" categories="COMPARISON"] precipitation than the southern, with a difference of [REPLACE value="420mm" categories="DIFFERENCE"] between them.

---

Example 2:

Paragraph:
The total energy consumption was 2400 kWh. Building A consumed twice as much as Building B, 
representing a ratio of 2.0.

Data:
[
  {building: "Building A", energy_kwh: 1600},
  {building: "Building B", energy_kwh: 800}
]

Output:
The total energy consumption was [REPLACE value="2400 kWh" categories="SUM"]. Building A consumed [REPLACE value="twice as much" categories="RATIO,COMPARISON"] as Building B, representing a ratio of [REPLACE value="2.0" categories="RATIO"].

---

Example 3:

Paragraph:
The best performing product achieved 95% satisfaction, while the worst scored only 62%. 
The mean satisfaction across all products was 78.5%.

Data:
[
  {product: "Product X", satisfaction: 95},
  {product: "Product Y", satisfaction: 78},
  {product: "Product Z", satisfaction: 62}
]

Output:
The [REPLACE value="best" categories="RANK,MIN_MAX"] performing product achieved [REPLACE value="95%" categories="MIN_MAX"], while the [REPLACE value="worst" categories="RANK,MIN_MAX"] scored only [REPLACE value="62%" categories="MIN_MAX"]. The mean satisfaction across all products was [REPLACE value="78.5%" categories="AVERAGE"].

---

Example 4:

Paragraph:
Combined sales reached $3.5M, with the top seller generating $1.8M. The gap between first and second place was $600K.

Data:
[
  {seller: "Seller A", sales_m: 1.8},
  {seller: "Seller B", sales_m: 1.2},
  {seller: "Seller C", sales_m: 0.5}
]

Output:
Combined sales reached [REPLACE value="$3.5M" categories="SUM"], with the top seller generating [REPLACE value="$1.8M" categories="MIN_MAX"]. The gap between first and second place was [REPLACE value="$600K" categories="DIFFERENCE, RANK"].

---

Example 5:

Paragraph:
The efficiency ratio improved from 0.65 to 0.82, an increase of 0.17. This is higher than the industry average of 0.74.

Data:
[
  {period: "Before", efficiency: 0.65},
  {period: "After", efficiency: 0.82},
  {period: "Industry", efficiency: 0.74}
]

Output:
The efficiency ratio improved from [REPLACE value="0.65" categories="DATA_RETRIEVAL"] to [REPLACE value="0.82" categories="DATA_RETRIEVAL"], an increase of [REPLACE value="0.17" categories="DIFFERENCE"]. This is [REPLACE value="higher" categories="COMPARISON"] than the industry average of [REPLACE value="0.74" categories="AVERAGE"].
